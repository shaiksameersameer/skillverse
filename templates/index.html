<!DOCTYPE html>
<html>
<head>
  <title>SkillVerse: Resume Matcher</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white p-6 min-h-screen">

  <h1 class="text-4xl font-bold mb-8 text-center text-green-400">SkillVerse: Resume Matcher</h1>

  <!-- Upload Form -->
  <form method="POST" enctype="multipart/form-data" class="max-w-xl mx-auto mb-10 space-y-4 bg-gray-800 p-6 rounded-lg shadow-lg">
    <input type="file" name="resume" required class="block w-full p-2 bg-gray-700 rounded">
    <input type="file" name="jd" required class="block w-full p-2 bg-gray-700 rounded">
    <button type="submit" class="w-full px-4 py-2 bg-blue-600 rounded hover:bg-blue-700">Check Match</button>
  </form>

  {% if match is not none %}
  <div class="max-w-4xl mx-auto mt-8 bg-gray-800 p-6 rounded-lg shadow-lg">

    <h2 class="text-2xl font-semibold text-center text-green-300 mb-4">Match Score: {{ match }}%</h2>

    <!-- Roles -->
    <div class="text-center text-sm text-yellow-300 mb-2">
      Resume Role: <strong>{{ resume_role }}</strong> | JD Role: <strong>{{ jd_role }}</strong>
    </div>

    <!-- ATS Score -->
    <div class="mb-4">
      <h3 class="text-white text-sm font-semibold mb-1">üìÑ ATS Resume Format Score</h3>
      <div class="w-full bg-gray-600 rounded-full h-3">
        <div class="bg-blue-400 h-3 rounded-full" style="width: {{ ats_score }}%"></div>
      </div>
      <p class="text-xs text-gray-300 mt-1">{{ ats_score }}% formatting quality</p>
    </div>

    <!-- Chart -->
    <div class="flex justify-center mb-6">
      <div class="w-64 h-64">
        <canvas id="matchChart"></canvas>
      </div>
    </div>

    <!-- Tips -->
    {% if tips %}
    <div class="bg-yellow-100 text-yellow-800 p-4 rounded mb-6">
      <h3 class="font-bold mb-2">üìå Tips to Improve:</h3>
      <ul class="list-disc ml-5">
        {% for tip in tips %}
        <li>{{ tip }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    <!-- Matched Skills -->
    {% if skills %}
    <div class="mt-8">
      <h2 class="text-2xl font-bold text-green-400 mb-4">‚úÖ Matched Skills</h2>
      {% for category, items in skills.items() %}
        {% if items %}
        <h3 class="text-lg font-semibold text-blue-300 mt-4">{{ category }}</h3>
        <div class="space-y-2">
          {% for skill in items %}
            <div>
              <span class="text-white text-sm">{{ skill | title }}</span>
              <div class="w-full bg-gray-600 rounded-full h-2.5">
                <div class="bg-green-500 h-2.5 rounded-full" style="width: 100%"></div>
              </div>
            </div>
          {% endfor %}
        </div>
        {% endif %}
      {% endfor %}
    </div>
    {% endif %}

    <!-- Missing Skills -->
    {% if missing %}
    <div class="mt-8">
      <h2 class="text-2xl font-bold text-red-400 mb-4">‚ùå Missing Skills</h2>
      {% for category, items in missing.items() %}
        {% if items %}
        <h3 class="text-lg font-semibold text-red-200 mt-3">{{ category }}</h3>
        <div class="space-y-2">
          {% for skill in items %}
            <div>
              <span class="text-white text-sm">{{ skill | title }}</span>
              <div class="w-full bg-gray-600 rounded-full h-2.5">
                <div class="bg-yellow-400 h-2.5 rounded-full" style="width: 40%"></div>
              </div>
            </div>
          {% endfor %}
        </div>
        {% endif %}
      {% endfor %}
    </div>
    {% endif %}

    <!-- Unmatched Skills -->
    {% if unmatched %}
    <div class="mt-8">
      <h2 class="text-2xl font-bold text-yellow-500 mb-4">‚ùó Unmatched Skills</h2>
      {% for category, items in unmatched.items() %}
        {% if items %}
        <h3 class="text-lg font-semibold text-yellow-300 mt-3">{{ category }}</h3>
        <div class="space-y-2">
          {% for skill in items %}
            <div>
              <span class="text-gray-300">{{ skill | title }}</span>
              <div class="w-full bg-gray-600 rounded-full h-2.5">
                <div class="bg-red-500 h-2.5 rounded-full" style="width: 20%"></div>
              </div>
            </div>
          {% endfor %}
        </div>
        {% endif %}
      {% endfor %}
    </div>
    {% endif %}

    <!-- PDF Download -->
    <div class="mt-6 text-center">
      <a href="/download_report" class="inline-block px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded">üì© Download PDF Report</a>
    </div>

  </div>

  <!-- Chart.js -->
  <script>
    const data = {
      labels: ["Matched Skills", "Unmatched Skills"],
      datasets: [{
        data: [{{ common }}, {{ total - common }}],
        backgroundColor: ["#10B981", "#EF4444"],
        borderColor: "#1F2937",
        borderWidth: 2
      }]
    };
    const config = {
      type: "pie",
      data: data,
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'bottom',
            labels: { color: 'white', font: { size: 14 } }
          }
        }
      }
    };
    new Chart(document.getElementById("matchChart"), config);
  </script>
  {% endif %}

</body>
</html>
